<!DOCTYPE html>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!--jQuery UI-->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>


    <!--Material Design Lite-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>
    <link rel="stylesheet" href="style.css">

    <style>
        /*.row {*/
            /*height: 775px*/
        /*}*/
        .hcon {
            text-align: center;
        }

        span {

            font-weight: bold;
            text-decoration: underline;
            text-align: center;
            font-size: 20px;
            font-family: cursive;
        }

        .content {
            text-align: center;
        }

        .socMed {
            text-align: right;
        }

        .thumbnail {
            height: 286px
        }

    </style>
    <script type="text/javascript">
        var switchTo5x = true;
    </script>
    <script type="text/javascript" src="https://ws.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">
        stLight.options({
            publisher: "e411443c-1f8b-4af6-a1d1-edcf6d7d0f1d",
            doNotHash: false,
            doNotCopy: false,
            hashAddressBar: false
        });
    </script>
</head>

<body>
<div class="container-fluid or">
    <div class="well">
        <div class="socMed">
            <span class='st_facebook_large' displayText='Facebook'></span>
            <span class='st_googleplus_large' displayText='Google +'></span>
            <span class='st_twitter_large' displayText='Tweet'></span>
            <span class='st_pinterest_large' displayText='Pinterest'></span>
            <span class='st_email_large' displayText='Email'></span>
        </div>
        <div class="hcon">
            <span>Ingredients of Doom<br></span>
            <br>
            <div class="addedIngredients"></div>
        </div>
    </div>
    <hr>
    <div class="content">
        <input type="text" placeholder="Choose your poison" id="poison">
        <br/>
        <button id="add" onclick="getValue()">Press Me</button>


        <hr>
        <button class="btn-active ing" value="Monosodium Glutamate (MSG)">Monosodium Glutamate (MSG)</button>
        <button class="btn-active ing" value="Aspartame">Aspartame</button>
        <button class="btn-active ing" value="High Fructose Corn Syrup (HFCS)">High Fructose Corn Syrup (HFCS)</button>
        <button class="btn-active ing" value="Agave Nectar">Agave Nectar</button>
        <button class="btn-active ing" value="Artificial Food Coloring">Artificial Food Coloring</button>
        <button class="btn-active ing" value="BHA and BHT">BHA and BHT</button>
        <button class="btn-active ing" value="Sodium Nitrite and Sodium Nitrate">Sodium Nitrite and Sodium Nitrate
        </button>
        <button class="btn-active ing" value="Potassium Bromate">Potassium Bromate</button>
        <button class="btn-active ing" value="Recombinant Bovine Growth Hormone (rBGH)">Recombinant Bovine Growth
            Hormone (rBGH)
        </button>
        <button class="btn-active ing" value="Refined Vegetable Oil">Refined Vegetable Oil</button>
    </div>
</div>

<hr>
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-2 sidenav">

            <ul class="nav nav-pills nav-stacked">
                <li><a href="#home">Home</a></li>
                <li><a href="#fridge">My Fridge</a></li>
                <li><a href="#recipes">My Recipes</a></li>
            </ul>
        </div>


        <div class="col-sm-10">
            <div class="jumbotron text-center ">
                <h1>What Should I Make?</h1>
                <p>Bringing the best recipes to your home</p>
                <form class="form-inline">
                    <input type="text" class="form-control" id="ingredientInput" size="50" placeholder="Enter your ingredients" required>
                    <button type="button" class="btn btn-danger">Go</button>
                </form>
            </div>

            <div class="row">
                <div id="stuff"></div>
            </div>

        </div>
    </div>
</div>

<script>

    var fakeAvailableIngArray = [
        "Monosodium Glutamate (MSG)",
        "Aspartame",
        "High Fructose Corn Syrup (HFCS)",
        "Agave Nectar",
        "Artificial Food Coloring",
        "BHA and BHT",
        "Sodium Nitrite and Sodium Nitrate",
        "Potassium Bromate",
        "Recombinant Bovine Growth Hormone (rBGH)",
        "Refined Vegetable Oil",
    ];

    var auto = function (){
        $( "#poison" ).autocomplete({
            source: fakeAvailableIngArray
        });
    };

    var fridge = [];

    $('.ing').click(function () {
        var val = $(this).attr("value");
        fridge.push(val);
        console.log("Ingredients Added to Fridge", fridge);
        view();

    });

    var getValue = function () {
        $('input').each(function () {
            var theValue = $(this).val();
            fridge.push(theValue);
            //console.log(fridge);
            view()
        });

        $('#poison').focus(function () {
            $(this).val('');
        });
    };

    var removeIng = function () {
        var text = $(this).text();
        text = text.substring(0, text.length - 2);
        console.log("text is:" + text);
        fridge.splice(fridge.indexOf(text), 1);
        $(this).closest("button").remove();

        console.log("Current Items in Fridge", fridge)

    };

    var addClickHandlerToRemovableIngredient = function (element) {

        element.on('click', removeIng);
    };

    var view = function () {
        var death = $("<button>").text(fridge[fridge.length - 1] + " x").addClass("addedIng");
        addClickHandlerToRemovableIngredient(death);
        $(".addedIngredients").append(death);
    };


    // Document Ready Function
    $("document").ready(function () {
        auto(); //non project related
        recipe_info_from_jsonphp_file();
    });

    // ajax call to json.php
    var ingredientsArray;
    var desingatedIngredients
    var recipe_info_from_jsonphp_file = function () {
        $.ajax({
            url: "db_prototype/testjson.php",
            dataType: "json",
            method: "post",
            success: function (response) {
                console.log("data from json.php\n", response);

                ingredientsArray = response.ingredientData;
                //console.log(ingredientsArray);

                $( "#ingredientInput" ).autocomplete({
                    source: ingredientsArray
                });

                console.log("hi0")
                var name;

                for (var i = 0; i < response.recipeData.length; i++) {
                    console.log("==========FIRSTLOOP==========")
                    var img = response.recipeData[i].img;
                    //console.log(img);


                    var recipeName = response.recipeData[i].name;
                    //var desingatedIngredients = response.recipeData[i].ingredients;
                    //console.log(recipeName);

                    for(var j = 0; j < response.recipeData[i].ingredients.length; j++){
                        //console.log("hi2")
                        var amount = response.recipeData[i].ingredients[j].amount;
                        var amountType = response.recipeData[i].ingredients[j].amountType;
                        name = response.recipeData[i].ingredients[j].name;
                        desingatedIngredients = amount + " " + amountType + " " + name
                        console.log(name)

//                        console.log(desingatedIngredients)
                    }

                    var theDiv = $("<div>", {
                        class: "col-md-3 col-sm-6",

                    });
                    var outterDiv = $("<div>", {
                        class: "card"
                    });
                    var img = $("<img>", {
                        src: img,
                        class: "thumbnail",
                        width: "100%",
                        height: "286px"
                    });
                    var innerDiv = $("<div>", {
                        class: "card-block",
                        height:"415px"         //set the height of card-block cards in following rows will line up correctly
                    });
                    var h4 = $("<h4>", {
                        class: "card-title",
                        text: recipeName
                    });
                    var li = $("<li>", {
                        class: "card-text",
                        text: name
                    });

                    var butt = $("<button>", {
                        class: "btn btn-primary",
                        text: "Go somewhere"
                    });


                    theDiv.append(outterDiv);
                    outterDiv.append(img, innerDiv);
                    innerDiv.append(h4, li, butt);


                    $("#stuff").append(theDiv);
                }
            }
        })
    };
//    /*
//     modal
//     Recipe Title
//     ingredients
//     */

</script>
</body>
</html>
